函数
------

几乎所有的高级语言都支持函数和类似函数的结构，函数之所以如此普遍和重要的原因如下：第一，现代计算机进程执行模型大部分是基于“堆栈”的，而编译器不需要对函数做过多的转换就能让其在栈上运行（只需要处理好参数和返回值的传递即可）；第二，函数对代码的抽象程度适中，就像胶水，很容易将编程语言的不同层级的抽象体“黏结起来”。



### 关于函数的一些特性

1、Go函数实参到形参的传递永远都是值拷贝（包括切片和字典）

2、可变参数在函数体内相当于切片，对切片的操作同样适合于对可变参数

3、形参为可变参数的函数和形参为切片的函数类型不相同



### defer

Go函数里提供了`defer`关键字，可以注册多个延迟调用，这些调用以先进后出（FILO）的顺序在函数返回前被执行。`defer`后面必须是函数或方法的调用，不能是语句，否则会报`expression in defer must be function call`。

`defer`语句必须先注册后才能执行，如果`defer`位于`return`之后，则`defer`会因为没有注册而不会执行。**当主动调用`os.Exit(status)`退出进程时，即使已经注册的`defer`也不会执行**。

`defer`的好处是可以在一定程度上避免资源泄露，特别是在有很多`return`语句且有很多资源需要关闭的场景中。**同时也要注意到`defer`会推迟资源的释放时间，可能导致大量内存或系统资源得不到释放。另外，`defer`相对于普通的函数调用需要间接的数据结构支持，相对于普通函数调用有一定的性能损耗**。



### 闭包

